# 外部数据源

您可以使用外部数据源功能，配置数据库账号，将RDS上的业务数据与IoT产生的运行时数据进行关联分析。支持结合实时计算功能进行实时数据分析，支持结合数据开发功能编写SQL进行自主数据分析。

目前仅支持RDS for MySql类型的数据源。您需要在RDS中，提前增加如下IP白名单。

**说明：** 当前暂不支持8.0版本RDS for MySql类型的数据源（后续将会支持），请使用低于8.0版本的RDS for MySql。

```
10.152.0.0/16,10.154.0.0/16,11.132.0.0/16,11.178.0.0/16,11.200.215.195,11.217.0.0/16,11.219.0.0/16,11.222.0.0/16,11.223.69.0/24,11.223.70.0/24,11.223.70.173,11.223.70.48,11.223.0.0/16,11.200.0.0/16,101.132.71.223,11.200.210.74,11.223.116.79,47.102.58.62,47.102.58.188,11.193.115.240,11.193.116.45,11.193.253.220,11.193.98.239,100.104.251.64/26,11.196.23.120,11.193.116.41,11.193.254.199,11.197.250.3,11.193.254.226,11.193.254.233,11.193.111.152,11.193.111.171,11.193.111.167,139.224.228.95,121.40.195.152,172.31.128.0/21,10.48.32.0/19,10.48.33.0/19,10.48.47.0/19
```

有关设置白名单的具体操作，请参见[设置白名单](https://help.aliyun.com/document_detail/43185.html)。

1.  登录[物联网平台控制台](http://iot.console.aliyun.com/)，在左侧导航栏选择**数据分析**。

2.  在数据分析页面上方导航栏中，选择**数据源**。

3.  选择**外部数据源**页签，单击**添加外部数据源**。

4.  填写数据源信息，并单击**下一步**。

    ![添加外部数据源](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1190618951/p65030.png)

    |参数|说明|
    |:-|:-|
    |数据源名称|设置数据源名称。支持汉字、英文字母、数字、下划线（\_），汉字算两个字符，最多不超过40个字符。|
    |数据源类型|目前仅支持RDS for MySql类型的数据源。此处只能选择RDS for MySql。|
    |运行环境|数据源的用途，目前有如下两种：     -   云端：作为业务数据源存在。用于数据分析产品中与设备数据做关联分析，或者作为分析后结果的存储表存在。
    -   边缘：只可在边缘流计算中使用。可用于业务数据源或者结果数据源。 |

5.  配置数据源参数，并单击**添加**。

    -   数据源运行环境为云端。

        ![添加数据源](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0216023261/p43743.png)

        |数据源配置|对应云产品信息|
        |:----|:------|
        |外网地址/端口|目前仅支持RDS的外网地址。|
        |实例ID|数据库实例的ID。|
        |数据库名称|数据库名称。|
        |数据库账号、数据库密码|数据库登录账号及对应密码。|
        |VPC|如果该数据库处于VPC网络内，填写此项有助于提升访问速度。|

        以上参数可以从RDS控制台上获取。

        ![RDS控制台](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0216023261/p43745.png)

        单击**确定**后，物联网平台将自动触发测试，检验是否连接正常。若提示报错信息，请更正参数后重新单击**确定**。

    -   数据源运行环境为边缘。

        ![添加数据源（边缘网关）](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1216023261/p65225.png)

        |数据源配置|对应云产品信息|
        |:----|:------|
        |IP地址|您MySQL数据库的IP地址。|
        |端口|您MySQL数据库的端口。|
        |数据库名称|您MySQL数据库的名称。|
        |数据库账号、数据库密码|您MySQL数据库登录账号及对应密码。|

    -   创建过程中，**元数据同步状态**显示**创建中**的状态。
    -   创建成功后，**元数据同步状态** 所在列显示**已完成**的状态。
    -   如果创建失败，**元数据同步状态** 所在列显示**失败**的状态。
    ![外部数据源_元数据同步](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1216023261/p77394.png)

6.  在数据源列表页面，支持按数据源名称进行模糊查询，也支持编辑、删除、同步元数据操作。

    当您在已经同步过元数据的库中新增了数据表或修改数据表中的字段时，您可以选择以下任意一种方法刷新。

    -   您可以单击**同步元数据**按钮，以更新该数据库的元数据信息，否则在数据开发中将无法查询并使用新增的数据表。
    -   您也可以在数据分析工作台中**数据资产** \> **数据表**模块的**外部数据源**下，查询和使用该数据库下的数据表。
    **说明：** 如果数据源被流计算任务、数据开发任务依赖了，则需要先去掉依赖才能删除数据源。


