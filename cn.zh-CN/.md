---
keyword: [数据分析, 数据服务, 物联网, API, 系统级对接]
---

# 数据服务

为了更加便捷和充分地利用数据资产，您可以通过数据分析的数据服务功能，使用默认的基础服务API和新建的自定义服务API，并掌握API的使用情况，最终实现物联网与自己云平台的系统级对接。本文介绍数据服务及其使用方法。

## 背景信息

-   基础服务API：您可以调用基础服务API，获取指定的数据信息。更多信息，请参见[查看与使用](#section_vto_96d_mm6)。
-   自定义服务API：您可以根据业务需要，新建自定义服务API。具体操作，请参见[新建自定义API](#section_yjf_yqv_26y)。

## 前提条件

已创建数据源相关的指标和数据集，具体信息，请参见[指标概述]()。

## 新建自定义API

1.  登录[物联网平台控制台](http://iot.console.aliyun.com/)[物联网平台控制台](https://partners-intl.console.aliyun.com/#/iot)。
2.  在实例概览页面，找到对应的数据型实例，单击实例进入实例详情页面。
3.  在左侧导航栏，选择**数据分析** \> **数据服务**。
4.  在**API列表**，单击**自定义服务API**后，单击**新建API**。
5.  在新建API页面，完成**API基础信息**的配置后，单击**下一步**。

    |参数|描述|
    |--|--|
    |API名称|输入API名称。支持支持中文、英文字母、数字、下划线（\_）。长度不超过30个字符。|
    |API Path|输入API Path。以正斜线（/）开头，支持支持英文字母、数字、下划线（\_）、正斜线（/）。长度不超过128个字符。例如：pk/temperatureMax。**说明：** API发布后，不可修改该参数。 |
    |API标签|输入标签内容后，按回车键，生成标签。使用标签功能，为API自定义标识，以便灵活管理API。一个API最多可添加5个标签。 |
    |API描述|输入API的描述，说明该API的功能或使用。|
    |返回类型|该参数不可自定义。调用API后，返回的数据格式为JSON。|

6.  在配置参数并测试页面，完成以下配置。

    |类别|参数|说明|
    |--|--|--|
    |数据源|指标域|选择指标域。指标域是指标所属的对象，用于分类管理指标。更多信息，请参见[什么是指标]()。|
    |数据集|选择对应指标域的数据集。数据集是指定指标域下设备数据的集合。更多信息，请参见[数据集概述]()。|
    |配置参数|数据集|完成数据源配置后，自动显示所选的数据集。单击**预览数据**，可跳转至该数据集的详情页。|
    |数据范围|选择API的数据范围。仅支持以下两项：    -   衍生指标：以原始定义为基础，并应用到子实体上的原始定义指标的衍生。
    -   衍生定义：基于原始指标、原始定义、衍生定义，经过加和、平均等汇总计算方式得到的数据。
更多信息，请参见[指标类型]()。 |
    |请求参数|单击**添加参数**，添加调用API的请求参数。请求参数可重复添加。添加的参数需包括绑定字段、参数名、参数类型、操作符、必选、示例值、参数描述。**说明：** 参数名不可定义为。 |
    |返回参数|单击**添加参数**，添加调用API时返回的参数。返回参数不可重复添加。添加的参数需包括优先级、绑定字段、参数名、参数类型、用于排序、示例值、参数描述。|
    |排序方式|    -   升序：参数以升序排列。默认排序为升序。
    -   降序：参数以降序排列。 |
    |高级设置|开启返回结果分页|默认返回结果不超过200条。    -   开启：可分页查看所有结果。
    -   不开启：仅可查看200条以内的结果。 |
    |超时报错设置|设置返回超时报错的时间。取值范围：5000~8000；单位：毫秒。|

    完成上述配置后，在**测试API**区域内，输入请求参数的测试值后，单击**开始测试**。

    您可在**返回示例**页签查看返回的示例数据，也可单击**请求详情**查看发起请求后的具体信息。

7.  单击**发布**。

    **说明：**

    -   发布API前，需确保该API已通过测试。
    -   仅单击**保存**的API，显示状态为未上线。
    -   未完成配置的API，可单击对应的**编辑**，完成配置后发布上线。
    在发布成功页面，单击**再次新建**，可创建多个自定义API；单击**去列表查看**，可查看已创建的API。


## 查看与使用

在**数据分析** \> **数据服务**页面的API列表，单击**基础服务API**或**自定义服务API**页签后，再单击列表中API的**查看**，可进入该API的详情页，查看其详情。

在右上角，选择版本号，查看对应版本的API详情。

-   单击**API运维**，可查看API的使用情况。
-   单击**API测试**，可测试API。
-   在**API测试**页签，单击**下载SDK**，可获取调用该API的代码。

