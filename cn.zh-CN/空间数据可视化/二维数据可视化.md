# 二维数据可视化 {#concept_uhs_zb5_cfb .concept}

二维数据可视化支持在地图上实时展示设备的运行状态，方便您查看并管理设备。同时支持将URL授权分享给其他用户，可用作数据展示大屏等。

二维数据可视化主要功能包括：

-   多种经典地图模板供用户选择
-   支持自定义展示设备运行状态
-   支持远程控制设备

二维数据可视化服务的操作视频请参见[二维数据可视化视频演示](../../../../cn.zh-CN/视频演示/二维数据可视化.md#)。

## 前提条件 {#section_nk2_jr2_2gb .section}

使用二维数据可视化服务之前，您必须为待使用该功能的设备配置地理位置。

目前有两种配置地理位置的方法，分别为配置设备标签和读取物模型中的地理位置属性。两种设置方法的详细操作请见[二维数据可视化设备定位](cn.zh-CN/空间数据可视化/二维数据可视化设备定位.md#)。

**说明：** 若在同一个设备上配置了两种定位方法，那么二维数据可视化服务会优先采用[物模型](../../../../cn.zh-CN/用户指南/产品与设备/物模型/概述.md#)中的动态定位数据，保证定位的实时性。

-   **配置设备标签** 

    适合不经常移动，自身不带定位功能的设备，比如门锁、基站铁塔、共享洗衣机等，配置一次地理位置即可。

-   **读取物模型中的地理位置属性** 

    适合带有定位功能的设备使用（卫星定位、wifi/基站网络定位、ip定位均可），比如物流追踪、共享单车等。


## 创建场景 {#section_odg_nvd_cfb .section}

1.  登录[物联网平台控制台](https://iot.console.aliyun.com/)。
2.  单击**数据分析** \> **空间数据可视化**。
3.  在二维数据可视化下，单击“**+**”号图标创建场景。
4.  根据参数说明设置场景参数，并单击**确定**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053444070_zh-CN.png)

    参数说明如下：

    |参数|说明|
    |--|--|
    |项目名称|设置您的场景项目名称，支持中文字和英文字符，不超过12个字符。|
    |目标产品或设备组| 选择部署场景的目标产品或设备组。

 目标产品或设备组中包含的设备，与您使用的场景模型关联。创建设备组的操作请参见[设备分组](../../../../cn.zh-CN/用户指南/产品与设备/设备分组.md#)。

 |
    |授权形式|授权形式，可分为**读取设备状态**与**读取并修改设备状态**。     -   选择**读取设备状态**表示您授权第三方读取您的设备状态，展示在页面上。
    -   选择**读取并修改设备状态**表示您授权第三方读取您的设备状态，并且操作您的设备来改变设备状态，主要用于对设备的远程控制。
 |
    |刷新频率|您可以根据设备实际使用情况进行设置，支持 秒、分钟、小时、天等时间间隔。|

5.  对地图上展示的设备数据进行配置。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053544071_zh-CN.png)

    -   弹框配置：

        单击**弹窗配置**，可以在此勾选希望展示/操作的属性，场景发布后点击气泡可弹出配置好的控制台弹窗。目前仅支持布尔型、枚举类型、数值类型、浮点型、双精度浮点型的属性。配置完成后单击**确定**使配置实时生效。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053544074_zh-CN.png)

    -   图标设置：

        单击**图标配置**，您可以设置设备图标形状。针对设备的某个属性可以分段设置不同的颜色用以呈现重要信息。另外还可以在设备图标上展示一种属性的数值，也可以选择不展示。配置完成后单击**确定**使配置实时生效。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053544075_zh-CN.png)

    弹窗和图表配置完成后：

    -   可在气泡弹出的窗口**属性**一栏中看到已勾选的属性。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053544079_zh-CN.png)

    -   可在气泡弹出的窗口**事件**一栏中看到该设备的事件上报记录。
6.  在界面右上角单击各个按钮可进行更多操作。

    地图右上角：

    -   单击**事件告警**，可查看所有设备的事件上报记录。
    -   单击**历史轨迹**，设置参数后，可查看设备移动的轨迹。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053546545_zh-CN.png)

        |参数|说明|
        |:-|:-|
        |轨迹时段|选择设备轨迹的时间段。 **说明：** 

        -   最多支持查询30天区间内的设备轨迹。
        -   播放轨迹时，最长可显示从起始日期起的7天时间的轨迹。
 |
        |选择设备|选择需要查询历史轨迹的设备。 **说明：** 

        -   建议选择有实际轨迹数据的设备，否则可能导致轨迹异常。
        -   最多支持同时查询5个设备轨迹。
 |
        |轨迹效果|历史轨迹显示的效果，包括精确轨迹点和平滑轨迹线。|

        设置完成参数后单击**生成轨迹**。

        在地图右上角，通过操作按钮可播放设备移动轨迹。

        **说明：** 

        -   精确轨迹点：是将已选“轨迹时段”内的实际设备移动时间，等比压缩到1分钟进行播放。
        -   平滑轨迹点：是不带时间戳的，即不显示设备上报位置的具体时间点，仅显示设备移动轨迹。
        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053546561_zh-CN.png)

    -   单击**热力图**，可查看设备的分布，每个场景默认有一个热力图配置，且不可删除。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053544326_zh-CN.png)

        单击热力图类型右侧的**添加**，可设置热力图展示模式。 配置完成后单击**确定**，保存配置。

        **说明：** 最多支持设置3个属性的热力图，即除了默认的设备分布热力图之外，还可额外增加2个属性的热力图。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644330_zh-CN.png)

        |参数|说明|
        |:-|:-|
        |热力图属性|包括设备分布和设备属性，但仅支持数值类型的设备属性（int，float和double）。         -   设备分布：按照设备的分布密度进行展示。
        -   设备数值属性：展示设备的数值属性热力图。
 |
        |热力图效果|包括热成像和点聚合两种模式。两种模式的效果可在样式说明中查看。|
        |配色|热力图的配色，目前有3种颜色可选。|

        在配置项下方单击**添加热力图**，可继续增加配置项。

        热力图效果配置示例如下：

        -   热力图属性为设备分布，热力图效果为热成像，设备密度高，则配色偏左，反之偏右。

            ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644336_zh-CN.png)

        -   热力图属性为设备数值属性，热力图效果为热成像，则按照每个设备物模型中属性参数值的高低展示颜色。

            **说明：** 设备物模型中属性参数值越高，热成像效果图中显示的颜色越深。例如，设备物模型中属性的参数值取值范围为1~100，当属性值为1时颜色最浅，属性值接近100时颜色最深。

            ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644337_zh-CN.png)

        -   热力图属性为设备数值属性，热力图效果为点集合，则系统会自动对距离较近的设备进行聚合，并对数值属性进行求和或者求平均值。该项配置适用于PM2.5监测等场景。

            **说明：** 系统会获取场景下所有带定位设备当前最新属性数据加权平均值。例如，当前场景有5个带定位的设备，其中4个有属性数据，那么会将4个设备的加权数据平均到5个设备上，显示在二维场景中。

            ``` {#codeblock_lyv_8vi_swi}
            （Dev1有值+Dev2有值+Dev3有值+Dev4有值+Dev5无值）÷ 5
            ```

            ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644338_zh-CN.png)

    二维数据可视化页面右上角：

    -   单击**批量导入设备位置**，可重管理二维数据可视化场景中关联的设备位置。
        1.  单击**批量导入设备位置**后的`？`号图标，系统显示如下图信息。

            ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644349_zh-CN.png)

        2.  单击**下载数据**会下载一个.csv文件（可用Excel打开），该文件包含二维数据可视化场景中绑定的产品或设备组下所有设备对应的productKey、deviceName和location。
        3.  在location一列填写对应设备的经纬度（可使用[高德开放平台](https://lbs.amap.com/console/show/picker)经纬度拾取工具）并保存文件。示例如下：

            **说明：** 将设备的经纬度以英文冒号（`:`）分隔，冒号前填写经度，冒号后填写维度。

            ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644350_zh-CN.png)

        4.  单击**批量导入设备位置**，上传已填写好location的.csv文件，则二维数据可视化场景中显示对应设备的位置。

            如果需要清除设备位置，您可以在.csv文件对应设备后删除location一列的值，并重新上传.csv文件即可。

            **说明：** 

            -   如果设备主动通过Geolocation属性（即在控制台设置设备标签）上报位置，会覆盖.csv文件的上传结果。
            -   如果.csv文件和Geolocation属性都记录了设备经纬度，会以Geolocation属性上报的位置为准。
    -   单击**编辑**，可重置场景信息，参数请参见[场景参数说明](#)。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644081_zh-CN.png)

    -   单击**预览**，可以全屏观看，键盘按**Esc**可退出全屏。
    -   单击**分享**，通过两种分享方式将链接分享给其他人。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/155550/155747053644083_zh-CN.png)

        两种分享方式说明如下，详细的配置方法请参见[分享场景](cn.zh-CN/空间数据可视化/分享场景.md#)：

        |分享方式|描述|
        |:---|:-|
        |授权登录访问|通过授权手机号码分享场景，适合单独使用二维数据可视化服务的场景。|
        |免登录访问|生成一个无需登录就能访问的URL，用户通过该URL直接访问已编辑好的二维数据可视化场景，适合需要将二维数据可视化做嵌入集成的用户或企业。|


